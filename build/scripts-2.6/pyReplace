#!/usr/bin/python

import os
import sys
import shutil

# Replace string in file
def fReplace(stext, rtext, iFile):
    input  = open(iFile)
    output = open('.temp', 'w')
    count  = 0
    for s in input.xreadlines():
        count += s.count(stext)
        output.write(s.replace(stext, rtext))
    input.close()
    output.close()
    if count > 0:
        shutil.move('.temp', iFile)
    else:
    	os.remove('.temp')
    return count


usage = "usage: %s search_text replace_text [infile [outfile]]" % os.path.basename(sys.argv[0])

if len(sys.argv) < 3:
    print usage
    print 'number of arguments supplied=', len(sys.argv)-1
    exit(0)
else:
    stext = sys.argv[1]
    rtext = sys.argv[2]
    argList  = sys.argv
    del argList[0:3]
count = 0
for file in argList:
    count += fReplace(stext, rtext, file)
exit(count)
